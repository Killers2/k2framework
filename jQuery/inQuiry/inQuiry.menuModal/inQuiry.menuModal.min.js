/*!
 * PLUGIN inQuiry ToolTip  V1.2
 * @laguage: Javascript ES6
 * @author: Tony N. Hyde (Date: 23 January 2022)
 * @Dependencies: jQuery, inQuiry.Extentions.js, inQuiry.toolTip.js
 */
!function($){"use strict";$.menuModalLoader={ASYNC:1,IFRAME:2,CONTENT:3,SCRIPT:4};class menuModal{id;name;container;items;onMenuBuilt;prevSelected;constructor(options){this.id=options.id,this.name=options.name,this.container=options.container,this.onMenuBuilt=options.onBuilt,this.items=[],this.prevSelected=null;for(var i=0;i<options.items.length;i++)this.items.push(this.menuItem(options.items[i]));this.build()}menuItem=function(options){var defaults={loader:$.menuModalLoader.CONTENT,method:"",label:"",fontAwsomeIconClass:"",eventConfig:null,toolTipConfig:null,button:null,belongsTo:null,disabled:!1,section:null};return{loader:(options=$.extend({},defaults,options)).loader,method:options.method,label:options.label,fontAwsomeIconClass:options.fontAwsomeIconClass,eventConfig:options.eventConfig,toolTipConfig:options.toolTipConfig,section:options.section,button:null,belongsTo:null,disabled:!1,create:function(defaultClass,parent){this.belongsTo=parent;var a=$("<li />",{"data-uri-loader":options.loader});return options.loader!=$.menuModalLoader.ASYNC&&options.loader!=$.menuModalLoader.IFRAME||a.attr("data-uri",options.method),defaultClass&&a.addClass(defaultClass),options.toolTipConfig&&$(a).uiToolTip({content:options.toolTipConfig.content,maxWidth:options.toolTipConfig.maxWidth,position:options.toolTipConfig.toolTipPos}),a.html('<i class="'+options.fontAwsomeIconClass+'"></i><label>'+options.label+"</label>"),options.eventConfig&&options.eventConfig.onClickEvent?a.on("click",evt=>{options.eventConfig.onClickEvent(a[0],this)}):a.on("click",evt=>{this.belongsTo.onItemClickDefault(a[0],this)}),this.button=a[0],this.button}}};build=function(){var a,b,c,d,f,g,h,j,dClass="",me=this;$(me.container).attr("data-menu-modal-id",me.id);var a=$("<div />",{class:"window-tab-menu"}),b=$("<div />",{class:"window-tab-menu-screen"}),c=$("<ul />",{id:"window-tab-menu"});$.each(me.items,(idx,item)=>{item.disabled||(dClass=null,0==idx&&(dClass="current"),idx==me.items.length-1&&(dClass="last"),c.append($(item.create(dClass,me))))}),a.append(c);var d=$("<div />",{class:"window-tab-menu-row window-tab-menu-row-padding"}),f=$("<div />",{class:"window-tab-menu-row window-tab-menu-row-height"}),g=$("<div />",{id:"window-tab-menu-circle-logo",class:"window-tab-menu-circle-logo"}),h=$("<div />",{id:"window-tab-menu-circle-logo-text",class:"window-tab-menu-circle-logo-text"});g.html("MM"),h.html("Header Menu."),d.append(g),d.append(h);var j=$("<div />",{id:"window-tab-menu-view",class:"window-tab-menu-view"});f.append(j),b.append(d),b.append(f),$(me.container).append(a),$(me.container).append(b),$(me.container).addClass("window-tabs-container"),$($(me.container).find("#window-tab-menu")[0].children[0]).trigger("click"),me.onMenuBuilt&&me.onMenuBuilt()};onItemClickDefault=function(li,item){var ul=li.parentNode,viewBox="window-tab-menu-view";item.belongsTo.items.length>1&&($.each(ul.children,(idx,liItem)=>{$(liItem).removeClass("current").removeClass("before").removeClass("after")}),$(li).addClass("current"),li.previousSibling&&$(li.previousSibling).addClass("before"),li.nextSibling&&$(li.nextSibling).addClass("after"));var hText="";if(item.belongsTo.name&&(hText+=item.belongsTo.name+" / "),hText+=$(li).find("label").html(),$("#window-tab-menu-circle-logo-text").html(hText),$("#"+viewBox).html(""),item.belongsTo.prevSelected&&item.belongsTo.prevSelected.eventConfig&&(window.document.removeEventListener("iframe.event.receiver",item.belongsTo.prevSelected.eventConfig.onIframeEventReceive,!1),item.belongsTo.prevSelected.eventConfig.onContentClear&&item.belongsTo.prevSelected.eventConfig.onContentClear()),item.belongsTo.prevSelected=item,item.loader==$.menuModalLoader.SCRIPT&&(item.eventConfig&&item.eventConfig.onContentLoading&&item.eventConfig.onContentLoading(),"function"==typeof item.method&&item.method(),item.eventConfig&&item.eventConfig.onContentLoaded&&item.eventConfig.onContentLoaded()),item.loader==$.menuModalLoader.CONTENT&&(item.eventConfig&&item.eventConfig.onContentLoading&&item.eventConfig.onContentLoading(),$("#"+viewBox).html(item.method),item.eventConfig&&item.eventConfig.onContentLoaded&&item.eventConfig.onContentLoaded()),item.loader==$.menuModalLoader.IFRAME){var a=$("<iframe />",{id:"window-tab-menu-window-iframe",class:"window-tab-menu-window-iframe",frameborder:"0"});null!=item.method&&a.attr("src",item.method),$("#"+viewBox).append(a),item.eventConfig&&item.eventConfig.onIframeEventReceive&&window.document.addEventListener("iframe.event.receiver",item.eventConfig.onIframeEventReceive,!1)}if(item.loader==$.menuModalLoader.ASYNC){item.eventConfig&&item.eventConfig.onContentLoading&&item.eventConfig.onContentLoading();var pjaxOption=null,pjaxAutoRun=!0;item.section&&(pjaxOption={fragment:item.section,requestUrl:item.method}),$.ajax({type:"get",url:item.method,success:(data,status,xhr)=>{if(pjaxOption&&$.inQuiry.pjax){var pjax=new $.inQuiry.pjax,page=pjax.extractContainer(data,xhr,pjaxOption);try{document.activeElement.blur()}catch(e){}page.title&&(document.title=page.title);var context=$("#"+viewBox);pjax.renderTags([...page.scripts,...page.cssLinks],()=>{context.html(page.contents),context.append(page.scripts.filter((idx,s)=>""==s.src));var autofocusEl=context.find("input[autofocus], textarea[autofocus]").last()[0];autofocusEl&&document.activeElement!==autofocusEl&&autofocusEl.focus();var scrollTo=page.scrollTo;if(page.url.hash){var name=decodeURIComponent(page.url.hash.slice(1)),target=document.getElementById(name)||document.getElementsByName(name)[0];target&&(scrollTo=$(target).offset().top)}"number"==typeof scrollTo&&$(window).scrollTop(scrollTo),pjaxAutoRun&&context.find("script").each((idx,item)=>{eval($(item).text())}),item.eventConfig&&item.eventConfig.onContentLoaded&&item.eventConfig.onContentLoaded()})}else $("#"+viewBox).html(data),pjaxAutoRun&&$("#"+viewBox).find("script").each((idx,item)=>{eval($(item).text())}),item.eventConfig&&item.eventConfig.onContentLoaded&&item.eventConfig.onContentLoaded()},error:(xhr,status,error)=>{},statusCode:{500:xhr=>{}}})}}}$.fn.menuModal=function(options){var defaults={id:"menu-modal",name:"menuModal",container:this[0],items:[],onBuilt:()=>{}};return options=$.extend({},defaults,options),this[0].menuModal=new menuModal(options),this}}(jQuery);